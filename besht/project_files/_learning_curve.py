import matplotlib.pyplot as plt

# --------------------------
# Metrics manually extracted from your logs
# --------------------------
epochs = list(range(1, 37))  # Up to epoch 36 (you can extend if you continue training)

train_loss = [
    2.471547, 1.931572, 1.766905, 1.667557, 1.616980, 1.555588,
    1.532197, 1.499528, 1.484369, 1.464839, 1.437950, 1.421973,
    1.415156, 1.407122, 1.397420, 1.391520, 1.381667, 1.372750,
    1.290239, 1.283543, 1.274829, 1.263007, 1.266299, 1.251248,
    1.256658, 1.244848, 1.252527, 1.240167, 1.244883, 1.234901,
    1.224937, 1.226937, 1.222525, 1.186105, 1.192029, 1.181654
]

val_loss = [
    2.068914, 1.883101, 1.752091, 1.661063, 1.680696, 1.594409,
    1.570458, 1.530424, 1.497589, 1.501261, 1.501465, 1.455551,
    1.428785, 1.425377, 1.428385, 1.454048, 1.433616, 1.428322,
    1.357978, 1.350702, 1.336136, 1.365449, 1.319507, 1.291384,
    1.313993, 1.288008, 1.335543, 1.291673, 1.318556, 1.317180,
    1.288282, 1.290356, 1.301849, 1.247381, 1.257729, 1.227677
]

pesq = [
    1.4479, 1.4903, 1.4785, 1.5713, 1.5566, 1.6273,
    1.5323, 1.6408, 1.6127, 1.6193, 1.7089, 1.6735,
    1.6497, 1.7133, 1.6532, 1.6500, 1.6591, 1.6806,
    1.7245, 1.7472, 1.7368, 1.7551, 1.7055, 1.7411,
    1.7647, 1.7395, 1.7684, 1.7222, 1.8333, 1.7224,
    1.7694, 1.7832, 1.7870, 1.8278, 1.7693, 1.8387
]

stoi = [
    0.8822, 0.8999, 0.9056, 0.9101, 0.9081, 0.9163,
    0.9207, 0.9222, 0.9228, 0.9213, 0.9216, 0.9251,
    0.9266, 0.9264, 0.9230, 0.9225, 0.9262, 0.9261,
    0.9264, 0.9329, 0.9329, 0.9301, 0.9311, 0.9323,
    0.9295, 0.9340, 0.9323, 0.9324, 0.9303, 0.9279,
    0.9336, 0.9341, 0.9308, 0.9361, 0.9350, 0.9402
]

sisdr = [
    9.9323, 10.8254, 11.4632, 11.8946, 11.8328, 12.2275,
    12.3278, 12.5392, 12.6870, 12.6628, 12.6561, 12.9163,
    13.0297, 13.0463, 13.0258, 12.9242, 13.0200, 13.0263,
    13.3939, 13.4322, 13.4827, 13.3537, 13.5546, 13.7050,
    13.5980, 13.7140, 13.5014, 13.6937, 13.5527, 13.6002,
    13.7417, 13.7117, 13.6618, 13.9745, 13.9085, 14.0535
]

# --------------------------
# Plot all metrics
# --------------------------
plt.figure(figsize=(14, 10))

# 1️⃣ Train vs Val Loss
plt.subplot(2, 2, 1)
plt.plot(epochs, train_loss, label='Train Loss', marker='o')
plt.plot(epochs, val_loss, label='Val Loss', marker='o')
plt.xlabel('Epoch')
plt.ylabel('Loss')
plt.title('Training & Validation Loss')
plt.legend()
plt.grid(True, linestyle='--', alpha=0.5)

# 2️⃣ PESQ
plt.subplot(2, 2, 2)
plt.plot(epochs, pesq, color='purple', marker='o')
plt.xlabel('Epoch')
plt.ylabel('PESQ')
plt.title('PESQ over Epochs')
plt.grid(True, linestyle='--', alpha=0.5)

# 3️⃣ STOI
plt.subplot(2, 2, 3)
plt.plot(epochs, stoi, color='green', marker='o')
plt.xlabel('Epoch')
plt.ylabel('STOI')
plt.title('STOI over Epochs')
plt.grid(True, linestyle='--', alpha=0.5)

# 4️⃣ SI-SDR
plt.subplot(2, 2, 4)
plt.plot(epochs, sisdr, color='orange', marker='o')
plt.xlabel('Epoch')
plt.ylabel('SI-SDR (dB)')
plt.title('SI-SDR over Epochs')
plt.grid(True, linestyle='--', alpha=0.5)

plt.tight_layout()
plt.show()
